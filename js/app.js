!function e(t,i,n){function r(s,a){if(!i[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=i[s]={exports:{}};t[s][0].call(l.exports,function(e){var i=t[s][1][e];return r(i||e)},l,l.exports,e,t,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){requestAnimationFrame(r),f.renderLoop(e),o(),d.renderer.render(d.scene,d.camera)}function o(){m.textContent=h.myPlayer.score,v.textContent=h.myPlayer.money}var s=e("./modules/view"),a=e("./modules/game-engine"),c=n(a),u=e("./modules/game-view"),l=n(u),d=void 0,h=void 0,f=void 0,m=void 0,v=void 0;!function(){var e=(0,s.setupScreenView)(),t=e.scene,i=e.camera,n=e.renderer;d={scene:t,camera:i,renderer:n},h=new c.default(d),f=new l.default(d,h),m=document.getElementById("score"),v=document.getElementById("money"),window.addEventListener("click",function(){var e=f.getCurrentPanelIndex();if(e>=0){var i=h.myPlayer.spawnMinion(e);i&&t.add(i.viewObj)}}),window.addEventListener("keypress",function(){var e=h.computer.spawnMinion(3);e&&t.add(e.viewObj)}),r()}()},{"./modules/game-engine":3,"./modules/game-view":4,"./modules/view":7}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.xPositive=1,i.xNegative=-1,i.gridWidth=70,i.gridSubDiv=8},{}],3:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("./player"),s=function(e){return e&&e.__esModule?e:{default:e}}(o),a=e("./constants"),c=function(){function e(t){n(this,e),this.state={},this.scene=t.scene,this.colliderSystem=new THREEx.ColliderSystem,this.colliderList=[],this.initializePlayers()}return r(e,[{key:"initializePlayers",value:function(){this.myPlayer=new s.default({type:"human",direction:a.xPositive,colliderList:this.colliderList,scene:this.scene}),this.computer=new s.default({type:"computer",direction:a.xNegative,colliderList:this.colliderList,scene:this.scene}),this.state.players=[this.myPlayer,this.computer]}},{key:"gameLoop",value:function(e){this.state.players.forEach(function(t){return t.runLoop(e)}),this.colliderSystem.computeAndNotify(this.colliderList)}}]),e}();i.default=c},{"./constants":2,"./player":6}],4:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("./constants"),s=function(){function e(t,i){n(this,e),this.scene=t.scene,this.camera=t.camera,this.renderer=t.renderer,this.gameEngine=i,this.setupGrid(),this.setupLight(),this.mouse={x:0,y:0},this.camera.position.z=50,this.camera.position.y=50,this.camera.lookAt(this.scene.position),this.raycaster=new THREE.Raycaster,this.currentHoveredPanel=null,this.setupMouseEvent()}return r(e,[{key:"setupLight",value:function(){var e=new THREE.AmbientLight(6710886),t=new THREE.PointLight(8947848);t.position.set(3,3,3),this.scene.add(e),this.scene.add(t)}},{key:"setupGrid",value:function(){var e=new THREE.GridHelper(o.gridWidth,o.gridSubDiv);this.scene.add(e),this.gridPanels={};for(var t=o.gridWidth/o.gridSubDiv,i=-30.6,n=0;n<8;n++){var r=new THREE.PlaneGeometry(o.gridWidth,t),s=new THREE.MeshBasicMaterial({color:6710886}),a=new THREE.Mesh(r,s);a.rotation.x=-.5*Math.PI,a.position.z=i,a.position.y=-.1,this.scene.add(a),this.gridPanels[n]=a,i+=t}}},{key:"checkGridIntersections",value:function(){this.raycaster.setFromCamera(this.mouse,this.camera);var e=Object.values(this.gridPanels),t=this.raycaster.intersectObjects(e);if(e.forEach(function(e){e.material.color.setHex(6710886)}),t.length>0){var i=t[0].object;i.material.color.setHex(16711680),this.currentHoveredPanel=i}else this.currentHoveredPanel&&(this.currentHoveredPanel=null)}},{key:"getCurrentPanelIndex",value:function(){if(this.currentHoveredPanel)for(var e=Object.values(this.gridPanels),t=0;t<8;t++)if(this.currentHoveredPanel===e[t])return t}},{key:"setupMouseEvent",value:function(){var e=this.mouse;window.addEventListener("mousemove",function(t){e.x=event.clientX/window.innerWidth*2-1,e.y=2*-(event.clientY/window.innerHeight)+1})}},{key:"renderLoop",value:function(e){this.checkGridIntersections(),this.gameEngine.gameLoop(e)}}]),e}();i.default=s},{"./constants":2}],5:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(t){n(this,e),this.direction=t.direction,this.colliderList=t.colliderList,this.id=t.id,this.health=10,this.attackStrength=3,this.speed=.5,this.attackProperties={lastTimeStamp:null,attackTime:0},this.destroy=!1,this.attack=!1,this.initializeView(t.startingZ),this.registerCollision()}return r(e,[{key:"initializeView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.25;this.viewObj=new THREE.Group;var i=new THREE.BoxGeometry(2,2,2),n=new THREE.MeshPhongMaterial({color:65280,specular:5592405,shininess:30}),r=new THREE.Mesh(i,n),o=new THREE.BoxGeometry(3,3,3),s=new THREE.MeshBasicMaterial({color:65535,transparent:!0,opacity:t}),a=new THREE.Mesh(o,s);this.hitBox=a,this.viewObj.add(r),this.viewObj.add(a),this.viewObj.position.z=9*e-32,this.viewObj.position.x=-38*this.direction,this.viewObj.position.y=2,this.hitBox.userData.minion=this}},{key:"registerCollision",value:function(){var e=this;this.hitBox.geometry.computeBoundingBox();var t=this.hitBox.geometry.boundingBox.clone();this.collider=new THREEx.ColliderBox3(this.hitBox,t),this.colliderList.push(this.collider),this.collider.addEventListener("contactEnter",function(t){e.speed=0,e.attack=!0,t.object3d.userData.minion.attack=!0,e.currentTarget=t}),this.collider.addEventListener("contactRemoved",function(t){e.speed=.5,e.attack=!1,e.currentTarget=null})}},{key:"runLoop",value:function(e){if(null!=this.attackProperties.lastTimeStamp&&this.attack){var t=e-this.attackProperties.lastTimeStamp;this.attackProperties.attackTime+=t,this.attackProperties.lastTimeStamp=e,this.attackLoop()}else this.attack&&(this.attackProperties.attackTime=0,this.attackProperties.lastTimeStamp=e,this.attackLoop());this.attackProperties.lastTimeStamp=e,this.viewObj.position.x+=this.speed*this.direction,this.collider.update()}},{key:"attackLoop",value:function(){this.attackProperties.attackTime>=500&&null!==this.currentTarget&&(this.currentTarget.object3d.userData.minion.health-=this.attackStrength,console.log(this.id,this.health),this.currentTarget.object3d.userData.minion.health<=0&&(this.currentTarget.object3d.userData.minion.attack=!1,this.currentTarget.object3d.userData.minion.destroy=!0,this.currentTarget=null),this.attackProperties.attackTime=0,this.attackProperties.lastTimeStamp=null)}}]),e}();i.default=o},{}],6:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("./minion"),s=function(e){return e&&e.__esModule?e:{default:e}}(o),a=function(){function e(t){n(this,e),this.type=t.type,this.direction=t.direction,this.colliderList=t.colliderList,this.scene=t.scene,this.minionId=0,this.setupGameState()}return r(e,[{key:"spawnMinion",value:function(e){if(this.money>=this.minionCost){this.money-=this.minionCost;var t=new s.default({id:this.minionId++,direction:this.direction,startingZ:e,colliderList:this.colliderList});return this.minions.push(t),t}return null}},{key:"runLoop",value:function(e){var t=this;this.minions.forEach(function(i,n){i.runLoop(e),i.destroy&&(t.scene.remove(i.viewObj),console.log(n,t.findColliderIndex(i.collider.id)),t.colliderList.splice(t.findColliderIndex(i.collider.id),1),t.minions.splice(n,1))})}},{key:"findColliderIndex",value:function(e){for(var t=-1,i=0;i<this.colliderList.length;i++)this.colliderList[i].id===e&&(t=i);return t}},{key:"setupGameState",value:function(){this.minions=[],this.score=0,this.money=400,this.minionCost=20}}]),e}();i.default=a},{"./minion":5}],7:[function(e,t,i){"use strict";function n(e,t){var i=window.innerWidth,n=window.innerHeight;e.setSize(i,n),t.aspect=i/n,t.updateProjectionMatrix()}function r(e,t){window.addEventListener("resize",function(){n(e,t)})}function o(){var e=new THREE.Scene,t=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),i=new THREE.WebGLRenderer;return i.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(i.domElement),r(i,t),{scene:e,camera:t,renderer:i}}Object.defineProperty(i,"__esModule",{value:!0}),i.setupScreenView=o},{}]},{},[1]);
//# sourceMappingURL=maps/app.js.map
