{"version":3,"sources":["app.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_interopRequireDefault","obj","__esModule","default","render","timestamp","requestAnimationFrame","gameView","renderLoop","updateUI","globals","renderer","scene","camera","scoreText","textContent","gameEngine","myPlayer","score","moneyText","money","_view","_gameEngine","_gameEngine2","_gameView","_gameView2","_setupScreenView","setupScreenView","document","getElementById","window","addEventListener","index","getCurrentPanelIndex","minion","spawnMinion","add","viewObj","computer","./modules/game-engine","./modules/game-view","./modules/view","2","Object","defineProperty","value","xPositive","xNegative","gridWidth","gridSubDiv","3","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","_player","_player2","_constants","GameEngine","args","this","state","colliderSystem","THREEx","ColliderSystem","colliderList","playerId","initializePlayers","type","direction","id","players","forEach","player","runLoop","computeAndNotify","./constants","./player","4","GameView","setupGrid","setupLight","mouse","x","y","position","z","lookAt","raycaster","THREE","Raycaster","currentHoveredPanel","setupMouseEvent","lightAmbient","AmbientLight","lightSource","PointLight","set","grid","GridHelper","gridPanels","panelLength","zPos","planeGeometry","PlaneGeometry","planeMaterial","MeshBasicMaterial","color","plane","Mesh","rotation","Math","PI","setFromCamera","planes","values","intersects","intersectObjects","panel","material","setHex","object","evt","event","clientX","innerWidth","clientY","innerHeight","checkGridIntersections","gameLoop","5","Minion","maxHealth","health","attackStrength","attackSpeed","defaultSpeed","speed","attackProperties","lastTimeStamp","attackTime","killReward","destroy","attack","initializeView","startingZ","registerCollision","hitBoxOpacity","arguments","undefined","Group","shapeGeometry","BoxGeometry","shapeMaterial","MeshPhongMaterial","specular","shininess","shapeMesh","hitGeometry","hitMaterial","transparent","opacity","hitMesh","healthBar","initializeHealthBar","hitBox","userData","_healthBarWidth","fullHealthBarGeometry","fullHealthBarMaterial","fullHealthBarMesh","name","emptyHealthBarGeometry","emptyHealthBarMaterial","emptyHealthBarMesh","healthBarGroup","_this","geometry","computeBoundingBox","box3","boundingBox","clone","collider","ColliderBox3","push","otherCollider","currentTarget","object3d","random","healthPercent","healthBarOffset","fullHealthBar","getObjectByName","scale","attackProcedure","update","updateHealthBar","delta","attackLoop","getAttackValue","console","log","processReward","6","_minion","_minion2","Player","minionId","setupGameState","minionCost","minions","reward","keys","remove","findColliderIndex","splice","./minion","7","handleResize","w","h","setSize","aspect","updateProjectionMatrix","setupResizing","Scene","PerspectiveCamera","WebGLRenderer","body","appendChild","domElement"],"mappings":"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","file":"../app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar _view = require('./modules/view');\n\nvar _gameEngine = require('./modules/game-engine');\n\nvar _gameEngine2 = _interopRequireDefault(_gameEngine);\n\nvar _gameView = require('./modules/game-view');\n\nvar _gameView2 = _interopRequireDefault(_gameView);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Globals\nvar globals = void 0;\n\nvar gameEngine = void 0,\n    gameView = void 0;\n\n// UI Elements\nvar scoreText = void 0,\n    moneyText = void 0;\n\n// Shapes\nvar cube;\n\nfunction init() {\n  var _setupScreenView = (0, _view.setupScreenView)(),\n      scene = _setupScreenView.scene,\n      camera = _setupScreenView.camera,\n      renderer = _setupScreenView.renderer;\n\n  globals = { scene: scene, camera: camera, renderer: renderer };\n\n  gameEngine = new _gameEngine2.default(globals);\n  gameView = new _gameView2.default(globals, gameEngine);\n\n  scoreText = document.getElementById('score');\n  moneyText = document.getElementById('money');\n\n  window.addEventListener('click', function () {\n    var index = gameView.getCurrentPanelIndex();\n    if (index >= 0) {\n\n      var minion = gameEngine.myPlayer.spawnMinion(index);\n      if (minion) {\n        scene.add(minion.viewObj);\n      }\n    }\n  });\n\n  window.addEventListener('keypress', function () {\n    var minion = gameEngine.computer.spawnMinion(3);\n    if (minion) {\n      scene.add(minion.viewObj);\n    }\n  });\n\n  render();\n}\n\nfunction render(timestamp) {\n  requestAnimationFrame(render);\n  gameView.renderLoop(timestamp);\n\n  updateUI();\n\n  globals.renderer.render(globals.scene, globals.camera);\n}\n\nfunction updateUI() {\n  scoreText.textContent = gameEngine.myPlayer.score;\n  moneyText.textContent = gameEngine.myPlayer.money;\n}\n\ninit();\n\n},{\"./modules/game-engine\":3,\"./modules/game-view\":4,\"./modules/view\":7}],2:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar xPositive = exports.xPositive = 1;\nvar xNegative = exports.xNegative = -1;\nvar gridWidth = exports.gridWidth = 70;\nvar gridSubDiv = exports.gridSubDiv = 8;\n\n},{}],3:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _player = require('./player');\n\nvar _player2 = _interopRequireDefault(_player);\n\nvar _constants = require('./constants');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar GameEngine = function () {\n  function GameEngine(args) {\n    _classCallCheck(this, GameEngine);\n\n    this.state = {};\n    this.scene = args.scene;\n    this.colliderSystem = new THREEx.ColliderSystem();\n    this.colliderList = [];\n\n    this.playerId = 0;\n\n    this.initializePlayers();\n  }\n\n  _createClass(GameEngine, [{\n    key: 'initializePlayers',\n    value: function initializePlayers() {\n      this.myPlayer = new _player2.default({\n        type: 'human',\n        direction: _constants.xPositive,\n        colliderList: this.colliderList,\n        scene: this.scene,\n        id: this.playerId++\n      });\n\n      this.computer = new _player2.default({\n        type: 'computer',\n        direction: _constants.xNegative,\n        colliderList: this.colliderList,\n        scene: this.scene,\n        id: this.playerId++\n      });\n\n      this.state.players = [this.myPlayer, this.computer];\n    }\n  }, {\n    key: 'gameLoop',\n    value: function gameLoop(timestamp) {\n      this.state.players.forEach(function (player) {\n        return player.runLoop(timestamp);\n      });\n      this.colliderSystem.computeAndNotify(this.colliderList);\n    }\n  }]);\n\n  return GameEngine;\n}();\n\nexports.default = GameEngine;\n\n},{\"./constants\":2,\"./player\":6}],4:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _constants = require('./constants');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar GameView = function () {\n  function GameView(globals, gameEngine) {\n    _classCallCheck(this, GameView);\n\n    this.scene = globals.scene;\n    this.camera = globals.camera;\n    this.renderer = globals.renderer;\n\n    this.gameEngine = gameEngine;\n\n    this.setupGrid();\n    this.setupLight();\n\n    this.mouse = { x: 0, y: 0 };\n\n    this.camera.position.z = 50;\n    this.camera.position.y = 50;\n    this.camera.lookAt(this.scene.position);\n\n    this.raycaster = new THREE.Raycaster();\n    this.currentHoveredPanel = null;\n\n    this.setupMouseEvent();\n  }\n\n  _createClass(GameView, [{\n    key: 'setupLight',\n    value: function setupLight() {\n      var lightAmbient = new THREE.AmbientLight(0x666666);\n      var lightSource = new THREE.PointLight(0x888888);\n\n      lightSource.position.set(3, 3, 3);\n\n      this.scene.add(lightAmbient);\n      this.scene.add(lightSource);\n    }\n  }, {\n    key: 'setupGrid',\n    value: function setupGrid() {\n      var grid = new THREE.GridHelper(_constants.gridWidth, _constants.gridSubDiv);\n      this.scene.add(grid);\n\n      this.gridPanels = {};\n\n      var panelLength = _constants.gridWidth / _constants.gridSubDiv;\n      var zPos = -30.6;\n\n      for (var i = 0; i < 8; i++) {\n        var planeGeometry = new THREE.PlaneGeometry(_constants.gridWidth, panelLength);\n        var planeMaterial = new THREE.MeshBasicMaterial({ color: 0x666666 });\n        var plane = new THREE.Mesh(planeGeometry, planeMaterial);\n        plane.rotation.x = -0.5 * Math.PI;\n        plane.position.z = zPos;\n        plane.position.y = -0.1;\n        this.scene.add(plane);\n        this.gridPanels[i] = plane;\n\n        zPos += panelLength;\n      }\n    }\n  }, {\n    key: 'checkGridIntersections',\n    value: function checkGridIntersections() {\n      this.raycaster.setFromCamera(this.mouse, this.camera);\n      var planes = Object.values(this.gridPanels);\n      var intersects = this.raycaster.intersectObjects(planes);\n\n      planes.forEach(function (panel) {\n        panel.material.color.setHex(0x666666);\n      });\n\n      if (intersects.length > 0) {\n        var obj = intersects[0].object;\n\n        obj.material.color.setHex(0xff0000);\n        this.currentHoveredPanel = obj;\n      } else if (this.currentHoveredPanel) {\n        this.currentHoveredPanel = null;\n      }\n    }\n  }, {\n    key: 'getCurrentPanelIndex',\n    value: function getCurrentPanelIndex() {\n      if (!this.currentHoveredPanel) {\n        return;\n      }\n\n      var planes = Object.values(this.gridPanels);\n\n      for (var i = 0; i < 8; i++) {\n        if (this.currentHoveredPanel === planes[i]) {\n          return i;\n        }\n      }\n    }\n  }, {\n    key: 'setupMouseEvent',\n    value: function setupMouseEvent() {\n      var mouse = this.mouse;\n\n      window.addEventListener('mousemove', function (evt) {\n        mouse.x = event.clientX / window.innerWidth * 2 - 1;\n        mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;\n      });\n    }\n  }, {\n    key: 'renderLoop',\n    value: function renderLoop(timestamp) {\n      this.checkGridIntersections();\n      this.gameEngine.gameLoop(timestamp);\n    }\n  }]);\n\n  return GameView;\n}();\n\nexports.default = GameView;\n\n},{\"./constants\":2}],5:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Minion = function () {\n  function Minion(args) {\n    _classCallCheck(this, Minion);\n\n    this.direction = args.direction;\n    this.colliderList = args.colliderList;\n    this.id = args.id;\n    this.playerId = args.playerId;\n    this.player = args.player;\n\n    this.maxHealth = 10;\n    this.health = this.maxHealth;\n    this.attackStrength = 3;\n    this.attackSpeed = 500;\n    this.defaultSpeed = 0.1;\n    this.speed = this.defaultSpeed;\n    this.attackProperties = {\n      lastTimeStamp: null,\n      attackTime: 0\n    };\n\n    this.killReward = {\n      money: 15,\n      score: 10\n    };\n\n    this.destroy = false;\n    this.attack = false;\n\n    this.initializeView(args.startingZ);\n    this.registerCollision();\n  }\n\n  _createClass(Minion, [{\n    key: \"initializeView\",\n    value: function initializeView(startingZ) {\n      var hitBoxOpacity = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : .25;\n\n      this.viewObj = new THREE.Group();\n\n      var shapeGeometry = new THREE.BoxGeometry(2, 2, 2);\n      var shapeMaterial = new THREE.MeshPhongMaterial({ color: 0x00ff00, specular: 0x555555, shininess: 30 });\n      var shapeMesh = new THREE.Mesh(shapeGeometry, shapeMaterial);\n\n      var hitGeometry = new THREE.BoxGeometry(3, 3, 3);\n      var hitMaterial = new THREE.MeshBasicMaterial({ color: 0x00ffff, transparent: true, opacity: hitBoxOpacity });\n      var hitMesh = new THREE.Mesh(hitGeometry, hitMaterial);\n\n      this.healthBar = this.initializeHealthBar();\n      this.hitBox = hitMesh;\n\n      this.viewObj.add(shapeMesh);\n      this.viewObj.add(hitMesh);\n      this.viewObj.add(this.healthBar);\n\n      this.viewObj.position.z = startingZ * 9 - 32;\n      this.viewObj.position.x = -38 * this.direction;\n      this.viewObj.position.y = 2;\n\n      this.hitBox.userData.minion = this;\n    }\n  }, {\n    key: \"initializeHealthBar\",\n    value: function initializeHealthBar() {\n      this._healthBarWidth = 2;\n      var fullHealthBarGeometry = new THREE.BoxGeometry(this._healthBarWidth, 0.1, 0.1);\n      var fullHealthBarMaterial = new THREE.MeshBasicMaterial({ color: 0x00ff00 });\n      var fullHealthBarMesh = new THREE.Mesh(fullHealthBarGeometry, fullHealthBarMaterial);\n      fullHealthBarMesh.name = \"FullHealthBar\";\n\n      var emptyHealthBarGeometry = new THREE.BoxGeometry(this._healthBarWidth, 0.09, 0.09);\n      var emptyHealthBarMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });\n      var emptyHealthBarMesh = new THREE.Mesh(emptyHealthBarGeometry, emptyHealthBarMaterial);\n      emptyHealthBarMesh.name = \"EmptyHealthBar\";\n\n      var healthBarGroup = new THREE.Group();\n      healthBarGroup.add(fullHealthBarMesh);\n      healthBarGroup.add(emptyHealthBarMesh);\n\n      healthBarGroup.position.y = 4;\n\n      return healthBarGroup;\n    }\n  }, {\n    key: \"registerCollision\",\n    value: function registerCollision() {\n      var _this = this;\n\n      this.hitBox.geometry.computeBoundingBox();\n      var box3 = this.hitBox.geometry.boundingBox.clone();\n      this.collider = new THREEx.ColliderBox3(this.hitBox, box3);\n\n      this.colliderList.push(this.collider);\n\n      this.collider.addEventListener('contactEnter', function (otherCollider) {\n        _this.speed = 0;\n        _this.attack = true;\n        _this.currentTarget = otherCollider.object3d.userData.minion;\n      });\n\n      this.collider.addEventListener('contactRemoved', function (otherCollider) {\n        _this.speed = _this.defaultSpeed;\n        _this.attack = false;\n        _this.currentTarget = null;\n      });\n    }\n  }, {\n    key: \"getAttackValue\",\n    value: function getAttackValue() {\n      return Math.random() * this.attackStrength;\n    }\n  }, {\n    key: \"updateHealthBar\",\n    value: function updateHealthBar() {\n      var healthPercent = this.health / this.maxHealth;\n      var healthBarOffset = -(1 - healthPercent) * this._healthBarWidth / 2;\n      var fullHealthBar = this.healthBar.getObjectByName('FullHealthBar');\n\n      fullHealthBar.scale.x = healthPercent;\n      fullHealthBar.position.x = healthBarOffset;\n    }\n  }, {\n    key: \"runLoop\",\n    value: function runLoop(timestamp) {\n      this.attackProcedure(timestamp);\n      this.viewObj.position.x += this.speed * this.direction;\n\n      this.collider.update();\n      this.updateHealthBar();\n    }\n  }, {\n    key: \"attackProcedure\",\n    value: function attackProcedure(timestamp) {\n      if (this.health <= 0) {\n        return;\n      }\n\n      if (this.attackProperties.lastTimeStamp != null && this.attack) {\n        var delta = timestamp - this.attackProperties.lastTimeStamp;\n        this.attackProperties.attackTime += delta;\n        this.attackProperties.lastTimeStamp = timestamp;\n        this.attackLoop();\n      } else if (this.attack) {\n        this.attackProperties.attackTime = 0;\n        this.attackProperties.lastTimeStamp = timestamp;\n        this.attackLoop();\n      }\n\n      this.attackProperties.lastTimeStamp = timestamp;\n    }\n  }, {\n    key: \"attackLoop\",\n    value: function attackLoop() {\n      if (this.currentTarget === null || this.currentTarget.playerId === this.playerId) {\n        return;\n      }\n      if (this.attackProperties.attackTime < this.attackSpeed) {\n        return;\n      }\n\n      this.currentTarget.health -= this.getAttackValue();\n\n      console.log(this.id, this.health);\n      if (this.currentTarget.health <= 0) {\n        this.player.processReward(this.currentTarget.killReward);\n\n        this.currentTarget.attack = false;\n        this.currentTarget.destroy = true;\n        this.currentTarget = null;\n      }\n\n      this.attackProperties.attackTime = 0;\n      this.attackProperties.lastTimeStamp = null;\n    }\n  }]);\n\n  return Minion;\n}();\n\nexports.default = Minion;\n\n},{}],6:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _minion = require('./minion');\n\nvar _minion2 = _interopRequireDefault(_minion);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Player = function () {\n  function Player(args) {\n    _classCallCheck(this, Player);\n\n    this.type = args.type;\n    this.id = args.id;\n    this.direction = args.direction;\n    this.colliderList = args.colliderList;\n    this.scene = args.scene;\n    this.minionId = 0;\n\n    this.setupGameState();\n  }\n\n  _createClass(Player, [{\n    key: 'spawnMinion',\n    value: function spawnMinion(index) {\n      if (this.money >= this.minionCost) {\n        this.money -= this.minionCost;\n\n        var minion = new _minion2.default({\n          id: this.minionId++,\n          playerId: this.id,\n          direction: this.direction,\n          startingZ: index,\n          colliderList: this.colliderList,\n          player: this\n        });\n\n        this.minions.push(minion);\n        return minion;\n      } else {\n        return null;\n      }\n    }\n  }, {\n    key: 'processReward',\n    value: function processReward(reward) {\n      var t = this;\n      Object.keys(reward).forEach(function (key) {\n        t[key] += reward[key];\n      });\n    }\n  }, {\n    key: 'runLoop',\n    value: function runLoop(timestamp) {\n      var _this = this;\n\n      this.minions.forEach(function (minion, index) {\n        minion.runLoop(timestamp);\n        if (minion.destroy) {\n          _this.scene.remove(minion.viewObj);\n\n          console.log(index, _this.findColliderIndex(minion.collider.id));\n          _this.colliderList.splice(_this.findColliderIndex(minion.collider.id), 1);\n\n          var a = _this.minions.splice(index, 1);\n        }\n      });\n    }\n  }, {\n    key: 'findColliderIndex',\n    value: function findColliderIndex(id) {\n      var index = -1;\n\n      for (var i = 0; i < this.colliderList.length; i++) {\n        if (this.colliderList[i].id === id) {\n          index = i;\n        }\n      }\n\n      return index;\n    }\n  }, {\n    key: 'setupGameState',\n    value: function setupGameState() {\n      this.minions = [];\n      this.score = 0;\n      this.money = 400;\n      this.minionCost = 20;\n    }\n  }]);\n\n  return Player;\n}();\n\nexports.default = Player;\n\n},{\"./minion\":5}],7:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.setupScreenView = setupScreenView;\nfunction handleResize(renderer, camera) {\n  var w = window.innerWidth;\n  var h = window.innerHeight;\n  renderer.setSize(w, h);\n  camera.aspect = w / h;\n  camera.updateProjectionMatrix();\n}\n\nfunction setupResizing(renderer, camera) {\n  window.addEventListener('resize', function () {\n    handleResize(renderer, camera);\n  });\n}\n\nfunction setupScreenView() {\n  var scene = new THREE.Scene();\n  var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);\n  var renderer = new THREE.WebGLRenderer();\n\n  renderer.setSize(window.innerWidth, window.innerHeight);\n  document.body.appendChild(renderer.domElement);\n\n  setupResizing(renderer, camera);\n\n  return { scene: scene, camera: camera, renderer: renderer };\n}\n\n},{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvYXBwLmpzIiwic3JjL2pzL21vZHVsZXMvY29uc3RhbnRzLmpzIiwic3JjL2pzL21vZHVsZXMvZ2FtZS1lbmdpbmUuanMiLCJzcmMvanMvbW9kdWxlcy9nYW1lLXZpZXcuanMiLCJzcmMvanMvbW9kdWxlcy9taW5pb24uanMiLCJzcmMvanMvbW9kdWxlcy9wbGF5ZXIuanMiLCJzcmMvanMvbW9kdWxlcy92aWV3LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQTs7QUFDQTs7OztBQUNBOzs7Ozs7QUFFQTtBQUNBLElBQUksZ0JBQUo7O0FBRUEsSUFBSSxtQkFBSjtBQUFBLElBQWdCLGlCQUFoQjs7QUFFQTtBQUNBLElBQUksa0JBQUo7QUFBQSxJQUFlLGtCQUFmOztBQUVBO0FBQ0EsSUFBSSxJQUFKOztBQUVBLFNBQVMsSUFBVCxHQUFnQjtBQUFBLHlCQUNvQiw0QkFEcEI7QUFBQSxNQUNSLEtBRFEsb0JBQ1IsS0FEUTtBQUFBLE1BQ0QsTUFEQyxvQkFDRCxNQURDO0FBQUEsTUFDTyxRQURQLG9CQUNPLFFBRFA7O0FBRWQsWUFBVSxFQUFFLFlBQUYsRUFBUyxjQUFULEVBQWlCLGtCQUFqQixFQUFWOztBQUVBLGVBQWEseUJBQWUsT0FBZixDQUFiO0FBQ0EsYUFBVyx1QkFBYSxPQUFiLEVBQXNCLFVBQXRCLENBQVg7O0FBRUEsY0FBWSxTQUFTLGNBQVQsQ0FBd0IsT0FBeEIsQ0FBWjtBQUNBLGNBQVksU0FBUyxjQUFULENBQXdCLE9BQXhCLENBQVo7O0FBRUEsU0FBTyxnQkFBUCxDQUF3QixPQUF4QixFQUFpQyxZQUFNO0FBQ3JDLFFBQUksUUFBUSxTQUFTLG9CQUFULEVBQVo7QUFDQSxRQUFHLFNBQVMsQ0FBWixFQUFlOztBQUViLFVBQUksU0FBUyxXQUFXLFFBQVgsQ0FBb0IsV0FBcEIsQ0FBZ0MsS0FBaEMsQ0FBYjtBQUNBLFVBQUcsTUFBSCxFQUFX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QUFDRDs7QUFFRCxTQUFTLGFBQVQsQ0FBdUIsUUFBdkIsRUFBaUMsTUFBakMsRUFBeUM7QUFDdkMsU0FBTyxnQkFBUCxDQUF3QixRQUF4QixFQUFrQyxZQUFNO0FBQ3RDLGlCQUFhLFFBQWIsRUFBdUIsTUFBdkI7QUFDRCxHQUZEO0FBR0Q7O0FBRU0sU0FBUyxlQUFULEdBQTJCO0FBQ2hDLE1BQUksUUFBUSxJQUFJLE1BQU0sS0FBVixFQUFaO0FBQ0EsTUFBSSxTQUFTLElBQUksTUFBTSxpQkFBVixDQUE0QixFQUE1QixFQUFnQyxPQUFPLFVBQVAsR0FBb0IsT0FBTyxXQUEzRCxFQUF3RSxHQUF4RSxFQUE2RSxJQUE3RSxDQUFiO0FBQ0EsTUFBSSxXQUFXLElBQUksTUFBTSxhQUFWLEVBQWY7O0FBRUEsV0FBUyxPQUFULENBQWlCLE9BQU8sVUFBeEIsRUFBb0MsT0FBTyxXQUEzQztBQUNBLFdBQVMsSUFBVCxDQUFjLFdBQWQsQ0FBMEIsU0FBUyxVQUFuQzs7QUFFQSxnQkFBYyxRQUFkLEVBQXdCLE1BQXhCOztBQUVBLFNBQU8sRUFBRSxZQUFGLEVBQVMsY0FBVCxFQUFpQixrQkFBakIsRUFBUDtBQUNEIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCB7IHNldHVwU2NyZWVuVmlldyB9IGZyb20gJy4vbW9kdWxlcy92aWV3JztcbmltcG9ydCBHYW1lRW5naW5lIGZyb20gJy4vbW9kdWxlcy9nYW1lLWVuZ2luZSc7XG5pbXBvcnQgR2FtZVZpZXcgZnJvbSAnLi9tb2R1bGVzL2dhbWUtdmlldyc7XG5cbi8vIEdsb2JhbHNcbmxldCBnbG9iYWxzO1xuXG5sZXQgZ2FtZUVuZ2luZSwgZ2FtZVZpZXc7XG5cbi8vIFVJIEVsZW1lbnRzXG5sZXQgc2NvcmVUZXh0LCBtb25leVRleHQ7XG5cbi8vIFNoYXBlc1xudmFyIGN1YmU7XG5cbmZ1bmN0aW9uIGluaXQoKSB7XG4gIGxldCB7IHNjZW5lLCBjYW1lcmEsIHJlbmRlcmVyIH0gPSBzZXR1cFNjcmVlblZpZXcoKTtcbiAgZ2xvYmFscyA9IHsgc2NlbmUsIGNhbWVyYSwgcmVuZGVyZXIgfTtcblxuICBnYW1lRW5naW5lID0gbmV3IEdhbWVFbmdpbmUoZ2xvYmFscyk7XG4gIGdhbWVWaWV3ID0gbmV3IEdhbWVWaWV3KGdsb2JhbHMsIGdhbWVFbmdpbmUpO1xuXG4gIHNjb3JlVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY29yZScpO1xuICBtb25leVRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9uZXknKTtcblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgbGV0IGluZGV4ID0gZ2FtZVZpZXcuZ2V0Q3VycmVudFBhbmVsSW5kZXgoKTtcbiAgICBpZihpbmRleCA+PSAwKSB7XG5cbiAgICAgIGxldCBtaW5pb24gPSBnYW1lRW5naW5lLm15UGxheWVyLnNwYXduTWluaW9uKGluZGV4KTtcbiAgICAgIGlmKG1pbmlvbikge1xuICAgICAgICBzY2VuZS5hZGQobWluaW9uLnZpZXdPYmopO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgKCkgPT4ge1xuICAgIGxldCBtaW5pb24gPSBnYW1lRW5naW5lLmNvbXB1dGVyLnNwYXduTWluaW9uKDMpO1xuICAgIGlmKG1pbmlvbikge1xuICAgICAgc2NlbmUuYWRkKG1pbmlvbi52aWV3T2JqKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJlbmRlcigpO1xufVxuXG5cbmZ1bmN0aW9uIHJlbmRlcih0aW1lc3RhbXApIHtcbiAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHJlbmRlcik7XG4gIGdhbWVWaWV3LnJlbmRlckxvb3AodGltZXN0YW1wKTtcblxuICB1cGRhdGVVSSgpO1xuXG4gIGdsb2JhbHMucmVuZGVyZXIucmVuZGVyKGdsb2JhbHMuc2NlbmUsIGdsb2JhbHMuY2FtZXJhKTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlVUkoKSB7XG4gIHNjb3JlVGV4dC50ZXh0Q29udGVudCA9IGdhbWVFbmdpbmUubXlQbGF5ZXIuc2NvcmU7XG4gIG1vbmV5VGV4dC50ZXh0Q29udGVudCA9IGdhbWVFbmdpbmUubXlQbGF5ZXIubW9uZXk7XG59XG5cbmluaXQoKTtcbiIsImV4cG9ydCBjb25zdCB4UG9zaXRpdmUgPSAxO1xuZXhwb3J0IGNvbnN0IHhOZWdhdGl2ZSA9IC0xO1xuZXhwb3J0IGNvbnN0IGdyaWRXaWR0aCA9IDcwO1xuZXhwb3J0IGNvbnN0IGdyaWRTdWJEaXYgPSA4O1xuIiwiaW1wb3J0IFBsYXllciBmcm9tICcuL3BsYXllcic7XG5pbXBvcnQgeyB4UG9zaXRpdmUsIHhOZWdhdGl2ZSB9IGZyb20gJy4vY29uc3RhbnRzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZUVuZ2luZSB7XG4gIGNvbnN0cnVjdG9yKGFyZ3MpIHtcbiAgICB0aGlzLnN0YXRlID0ge307XG4gICAgdGhpcy5zY2VuZSA9IGFyZ3Muc2NlbmU7XG4gICAgdGhpcy5jb2xsaWRlclN5c3RlbSA9IG5ldyBUSFJFRXguQ29sbGlkZXJTeXN0ZW0oKTtcbiAgICB0aGlzLmNvbGxpZGVyTGlzdCA9IFtdO1xuXG4gICAgdGhpcy5wbGF5ZXJJZCA9IDA7XG5cbiAgICB0aGlzLmluaXRpYWxpemVQbGF5ZXJzKCk7XG4gIH1cblxuICBpbml0aWFsaXplUGxheWVycygpIHtcbiAgICB0aGlzLm15UGxheWVyID0gbmV3IFBsYXllcih7XG4gICAgICB0eXBlOiAnaHVtYW4nLFxuICAgICAgZGlyZWN0aW9uOiB4UG9zaXRpdmUsXG4gICAgICBjb2xsaWRlckxpc3Q6IHRoaXMuY29sbGlkZXJMaXN0LFxuICAgICAgc2NlbmU6dGhpcy5zY2VuZSxcbiAgICAgIGlkOiB0aGlzLnBsYXllcklkKytcbiAgICB9KTtcblxuICAgIHRoaXMuY29tcHV0ZXIgPSBuZXcgUGxheWVyKHtcbiAgICAgIHR5cGU6ICdjb21wdXRlcicsXG4gICAgICBkaXJlY3Rpb246IHhOZWdhdGl2ZSxcbiAgICAgIGNvbGxpZGVyTGlzdDogdGhpcy5jb2xsaWRlckxpc3QsXG4gICAgICBzY2VuZTogdGhpcy5zY2VuZSxcbiAgICAgIGlkOiB0aGlzLnBsYXllcklkKytcbiAgICB9KTtcblxuICAgIHRoaXMuc3RhdGUucGxheWVycyA9IFsgdGhpcy5teVBsYXllciwgdGhpcy5jb21wdXRlciBdO1xuICB9XG5cbiAgZ2FtZUxvb3AodGltZXN0YW1wKSB7XG4gICAgdGhpcy5zdGF0ZS5wbGF5ZXJzLmZvckVhY2gocGxheWVyID0+IHBsYXllci5ydW5Mb29wKHRpbWVzdGFtcCkpO1xuICAgIHRoaXMuY29sbGlkZXJTeXN0ZW0uY29tcHV0ZUFuZE5vdGlmeSh0aGlzLmNvbGxpZGVyTGlzdCk7XG4gIH1cbn1cbiIsImltcG9ydCB7IGdyaWRXaWR0aCwgZ3JpZFN1YkRpdiB9IGZyb20gJy4vY29uc3RhbnRzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZVZpZXcge1xuICBjb25zdHJ1Y3RvcihnbG9iYWxzLCBnYW1lRW5naW5lKSB7XG4gICAgdGhpcy5zY2VuZSA9IGdsb2JhbHMuc2NlbmU7XG4gICAgdGhpcy5jYW1lcmEgPSBnbG9iYWxzLmNhbWVyYTtcbiAgICB0aGlzLnJlbmRlcmVyID0gZ2xvYmFscy5yZW5kZXJlcjtcblxuICAgIHRoaXMuZ2FtZUVuZ2luZSA9IGdhbWVFbmdpbmU7XG5cbiAgICB0aGlzLnNldHVwR3JpZCgpO1xuICAgIHRoaXMuc2V0dXBMaWdodCgpO1xuXG4gICAgdGhpcy5tb3VzZSA9IHsgeDogMCwgeTogMCB9O1xuXG4gICAgdGhpcy5jYW1lcmEucG9zaXRpb24ueiA9IDUwO1xuICAgIHRoaXMuY2FtZXJhLnBvc2l0aW9uLnkgPSA1MDtcbiAgICB0aGlzLmNhbWVyYS5sb29rQXQodGhpcy5zY2VuZS5wb3NpdGlvbik7XG5cblxuICAgIHRoaXMucmF5Y2FzdGVyID0gbmV3IFRIUkVFLlJheWNhc3RlcigpO1xuICAgIHRoaXMuY3VycmVudEhvdmVyZWRQYW5lbCA9IG51bGw7XG5cbiAgICB0aGlzLnNldHVwTW91c2VFdmVudCgpO1xuICB9XG5cbiAgc2V0dXBMaWdodCgpIHtcbiAgICBsZXQgbGlnaHRBbWJpZW50ID0gbmV3IFRIUkVFLkFtYmllbnRMaWdodCgweDY2NjY2Nik7XG4gICAgbGV0IGxpZ2h0U291cmNlID0gbmV3IFRIUkVFLlBvaW50TGlnaHQoMHg4ODg4ODgpO1xuXG4gICAgbGlnaHRTb3VyY2UucG9zaXRpb24uc2V0KDMsIDMsIDMpO1xuXG4gICAgdGhpcy5zY2VuZS5hZGQobGlnaHRBbWJpZW50KTtcbiAgICB0aGlzLnNjZW5lLmFkZChsaWdodFNvdXJjZSk7XG4gIH1cblxuICBzZXR1cEdyaWQoKSB7XG4gICAgdmFyIGdyaWQgPSBuZXcgVEhSRUUuR3JpZEhlbHBlcihncmlkV2lkdGgsIGdyaWRTdWJEaXYpO1xuICAgIHRoaXMuc2NlbmUuYWRkKGdyaWQpO1xuXG4gICAgdGhpcy5ncmlkUGFuZWxzID0ge307XG5cbiAgICBsZXQgcGFuZWxMZW5ndGggPSBncmlkV2lkdGggLyBncmlkU3ViRGl2O1xuICAgIGxldCB6UG9zID0gLTMwLjY7XG5cbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgICB2YXIgcGxhbmVHZW9tZXRyeSA9IG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KGdyaWRXaWR0aCwgcGFuZWxMZW5ndGgpO1xuICAgICAgdmFyIHBsYW5lTWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoe2NvbG9yOiAweDY2NjY2Nn0pO1xuICAgICAgdmFyIHBsYW5lID0gbmV3IFRIUkVFLk1lc2gocGxhbmVHZW9tZXRyeSxwbGFuZU1hdGVyaWFsKTtcbiAgICAgIHBsYW5lLnJvdGF0aW9uLnggPSAtMC41ICogTWF0aC5QSTtcbiAgICAgIHBsYW5lLnBvc2l0aW9uLnogPSB6UG9zO1xuICAgICAgcGxhbmUucG9zaXRpb24ueSA9IC0wLjE7XG4gICAgICB0aGlzLnNjZW5lLmFkZChwbGFuZSk7XG4gICAgICB0aGlzLmdyaWRQYW5lbHNbaV0gPSBwbGFuZTtcblxuICAgICAgelBvcyArPSBwYW5lbExlbmd0aDtcbiAgICB9XG4gIH1cblxuICBjaGVja0dyaWRJbnRlcnNlY3Rpb25zKCkge1xuICAgIHRoaXMucmF5Y2FzdGVyLnNldEZyb21DYW1lcmEodGhpcy5tb3VzZSwgdGhpcy5jYW1lcmEpO1xuICAgIGxldCBwbGFuZXMgPSBPYmplY3QudmFsdWVzKHRoaXMuZ3JpZFBhbmVscyk7XG4gICAgdmFyIGludGVyc2VjdHMgPSB0aGlzLnJheWNhc3Rlci5pbnRlcnNlY3RPYmplY3RzKHBsYW5lcyk7XG5cbiAgICBwbGFuZXMuZm9yRWFjaCgocGFuZWwpID0+IHtcbiAgICAgIHBhbmVsLm1hdGVyaWFsLmNvbG9yLnNldEhleCgweDY2NjY2Nik7XG4gICAgfSk7XG5cbiAgICBpZihpbnRlcnNlY3RzLmxlbmd0aCA+IDApIHtcbiAgICAgIGxldCBvYmogPSBpbnRlcnNlY3RzWzBdLm9iamVjdDtcblxuICAgICAgb2JqLm1hdGVyaWFsLmNvbG9yLnNldEhleCgweGZmMDAwMCk7XG4gICAgICB0aGlzLmN1cnJlbnRIb3ZlcmVkUGFuZWwgPSBvYmo7XG4gICAgfSBlbHNlIGlmKHRoaXMuY3VycmVudEhvdmVyZWRQYW5lbCl7XG4gICAgICB0aGlzLmN1cnJlbnRIb3ZlcmVkUGFuZWwgPSBudWxsO1xuICAgIH1cblxuICB9XG5cbiAgZ2V0Q3VycmVudFBhbmVsSW5kZXgoKSB7XG4gICAgaWYoIXRoaXMuY3VycmVudEhvdmVyZWRQYW5lbCkgeyByZXR1cm47IH1cblxuICAgIGxldCBwbGFuZXMgPSBPYmplY3QudmFsdWVzKHRoaXMuZ3JpZFBhbmVscyk7XG5cbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgICBpZih0aGlzLmN1cnJlbnRIb3ZlcmVkUGFuZWwgPT09IHBsYW5lc1tpXSkge1xuICAgICAgICByZXR1cm4gaTtcbiAgICAgIH1cbiAgICB9XG5cbiAgfVxuXG4gIHNldHVwTW91c2VFdmVudCgpIHtcbiAgICBsZXQgbW91c2UgPSB0aGlzLm1vdXNlO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIGV2dCA9PiB7XG4gICAgICBtb3VzZS54ID0gKCBldmVudC5jbGllbnRYIC8gd2luZG93LmlubmVyV2lkdGggKSAqIDIgLSAxO1xuICAgICAgbW91c2UueSA9IC0gKCBldmVudC5jbGllbnRZIC8gd2luZG93LmlubmVySGVpZ2h0ICkgKiAyICsgMTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlbmRlckxvb3AodGltZXN0YW1wKSB7XG4gICAgdGhpcy5jaGVja0dyaWRJbnRlcnNlY3Rpb25zKCk7XG4gICAgdGhpcy5nYW1lRW5naW5lLmdhbWVMb29wKHRpbWVzdGFtcCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIE1pbmlvbiB7XG4gIGNvbnN0cnVjdG9yKGFyZ3MpIHtcbiAgICB0aGlzLmRpcmVjdGlvbiA9IGFyZ3MuZGlyZWN0aW9uO1xuICAgIHRoaXMuY29sbGlkZXJMaXN0ID0gYXJncy5jb2xsaWRlckxpc3Q7XG4gICAgdGhpcy5pZCA9IGFyZ3MuaWQ7XG4gICAgdGhpcy5wbGF5ZXJJZCA9IGFyZ3MucGxheWVySWQ7XG4gICAgdGhpcy5wbGF5ZXIgPSBhcmdzLnBsYXllcjtcblxuICAgIHRoaXMubWF4SGVhbHRoID0gMTA7XG4gICAgdGhpcy5oZWFsdGggPSB0aGlzLm1heEhlYWx0aDtcbiAgICB0aGlzLmF0dGFja1N0cmVuZ3RoID0gMztcbiAgICB0aGlzLmF0dGFja1NwZWVkID0gNTAwO1xuICAgIHRoaXMuZGVmYXVsdFNwZWVkID0gMC4xO1xuICAgIHRoaXMuc3BlZWQgPSB0aGlzLmRlZmF1bHRTcGVlZDtcbiAgICB0aGlzLmF0dGFja1Byb3BlcnRpZXMgPSB7XG4gICAgICBsYXN0VGltZVN0YW1wOiBudWxsLFxuICAgICAgYXR0YWNrVGltZTogMFxuICAgIH07XG5cbiAgICB0aGlzLmtpbGxSZXdhcmQgPSB7XG4gICAgICBtb25leTogMTUsXG4gICAgICBzY29yZTogMTBcbiAgICB9XG5cbiAgICB0aGlzLmRlc3Ryb3kgPSBmYWxzZTtcbiAgICB0aGlzLmF0dGFjayA9IGZhbHNlO1xuXG4gICAgdGhpcy5pbml0aWFsaXplVmlldyhhcmdzLnN0YXJ0aW5nWik7XG4gICAgdGhpcy5yZWdpc3RlckNvbGxpc2lvbigpO1xuICB9XG5cbiAgaW5pdGlhbGl6ZVZpZXcoc3RhcnRpbmdaLCBoaXRCb3hPcGFjaXR5PS4yNSkge1xuICAgIHRoaXMudmlld09iaiA9IG5ldyBUSFJFRS5Hcm91cCgpO1xuXG4gICAgbGV0IHNoYXBlR2VvbWV0cnkgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoMiwyLDIpO1xuICAgIGxldCBzaGFwZU1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKHtjb2xvcjogMHgwMGZmMDAsIHNwZWN1bGFyOiAweDU1NTU1NSwgc2hpbmluZXNzOiAzMCB9KTtcbiAgICBsZXQgc2hhcGVNZXNoID0gbmV3IFRIUkVFLk1lc2goc2hhcGVHZW9tZXRyeSwgc2hhcGVNYXRlcmlhbCk7XG5cbiAgICBsZXQgaGl0R2VvbWV0cnkgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoMywzLDMpO1xuICAgIGxldCBoaXRNYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7Y29sb3I6IDB4MDBmZmZmLCB0cmFuc3BhcmVudDogdHJ1ZSwgb3BhY2l0eTogaGl0Qm94T3BhY2l0eSB9KTtcbiAgICBsZXQgaGl0TWVzaCA9IG5ldyBUSFJFRS5NZXNoKGhpdEdlb21ldHJ5LCBoaXRNYXRlcmlhbCk7XG5cbiAgICB0aGlzLmhlYWx0aEJhciA9IHRoaXMuaW5pdGlhbGl6ZUhlYWx0aEJhcigpO1xuICAgIHRoaXMuaGl0Qm94ID0gaGl0TWVzaDtcblxuICAgIHRoaXMudmlld09iai5hZGQoc2hhcGVNZXNoKTtcbiAgICB0aGlzLnZpZXdPYmouYWRkKGhpdE1lc2gpO1xuICAgIHRoaXMudmlld09iai5hZGQodGhpcy5oZWFsdGhCYXIpO1xuXG4gICAgdGhpcy52aWV3T2JqLnBvc2l0aW9uLnogPSAoc3RhcnRpbmdaICogOSkgLSAzMjtcbiAgICB0aGlzLnZpZXdPYmoucG9zaXRpb24ueCA9IC0zOCAqIHRoaXMuZGlyZWN0aW9uO1xuICAgIHRoaXMudmlld09iai5wb3NpdGlvbi55ID0gMjtcblxuICAgIHRoaXMuaGl0Qm94LnVzZXJEYXRhLm1pbmlvbiA9IHRoaXM7XG4gIH1cblxuICBpbml0aWFsaXplSGVhbHRoQmFyKCkge1xuICAgIHRoaXMuX2hlYWx0aEJhcldpZHRoID0gMjtcbiAgICBsZXQgZnVsbEhlYWx0aEJhckdlb21ldHJ5ID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KHRoaXMuX2hlYWx0aEJhcldpZHRoLCAwLjEsIDAuMSk7XG4gICAgbGV0IGZ1bGxIZWFsdGhCYXJNYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7Y29sb3I6IDB4MDBmZjAwfSk7XG4gICAgbGV0IGZ1bGxIZWFsdGhCYXJNZXNoID0gbmV3IFRIUkVFLk1lc2goZnVsbEhlYWx0aEJhckdlb21ldHJ5LCBmdWxsSGVhbHRoQmFyTWF0ZXJpYWwpO1xuICAgIGZ1bGxIZWFsdGhCYXJNZXNoLm5hbWUgPSBcIkZ1bGxIZWFsdGhCYXJcIjtcblxuICAgIGxldCBlbXB0eUhlYWx0aEJhckdlb21ldHJ5ID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KHRoaXMuX2hlYWx0aEJhcldpZHRoLCAwLjA5LCAwLjA5KTtcbiAgICBsZXQgZW1wdHlIZWFsdGhCYXJNYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7Y29sb3I6IDB4ZmYwMDAwfSk7XG4gICAgbGV0IGVtcHR5SGVhbHRoQmFyTWVzaCA9IG5ldyBUSFJFRS5NZXNoKGVtcHR5SGVhbHRoQmFyR2VvbWV0cnksIGVtcHR5SGVhbHRoQmFyTWF0ZXJpYWwpO1xuICAgIGVtcHR5SGVhbHRoQmFyTWVzaC5uYW1lID0gXCJFbXB0eUhlYWx0aEJhclwiO1xuXG4gICAgbGV0IGhlYWx0aEJhckdyb3VwID0gbmV3IFRIUkVFLkdyb3VwKCk7XG4gICAgaGVhbHRoQmFyR3JvdXAuYWRkKGZ1bGxIZWFsdGhCYXJNZXNoKTtcbiAgICBoZWFsdGhCYXJHcm91cC5hZGQoZW1wdHlIZWFsdGhCYXJNZXNoKTtcblxuICAgIGhlYWx0aEJhckdyb3VwLnBvc2l0aW9uLnkgPSA0O1xuXG4gICAgcmV0dXJuIGhlYWx0aEJhckdyb3VwO1xuICB9XG5cbiAgcmVnaXN0ZXJDb2xsaXNpb24oKSB7XG4gICAgdGhpcy5oaXRCb3guZ2VvbWV0cnkuY29tcHV0ZUJvdW5kaW5nQm94KClcbiAgICBsZXQgYm94MyA9IHRoaXMuaGl0Qm94Lmdlb21ldHJ5LmJvdW5kaW5nQm94LmNsb25lKCk7IFxuICAgIHRoaXMuY29sbGlkZXIgPSBuZXcgVEhSRUV4LkNvbGxpZGVyQm94Myh0aGlzLmhpdEJveCwgYm94Myk7XG5cbiAgICB0aGlzLmNvbGxpZGVyTGlzdC5wdXNoKHRoaXMuY29sbGlkZXIpO1xuXG4gICAgdGhpcy5jb2xsaWRlci5hZGRFdmVudExpc3RlbmVyKCdjb250YWN0RW50ZXInLCAob3RoZXJDb2xsaWRlcikgPT4ge1xuICAgICAgdGhpcy5zcGVlZCA9IDA7XG4gICAgICB0aGlzLmF0dGFjayA9IHRydWU7XG4gICAgICB0aGlzLmN1cnJlbnRUYXJnZXQgPSBvdGhlckNvbGxpZGVyLm9iamVjdDNkLnVzZXJEYXRhLm1pbmlvbjtcbiAgICB9KTtcblxuICAgIHRoaXMuY29sbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignY29udGFjdFJlbW92ZWQnLCAob3RoZXJDb2xsaWRlcikgPT4ge1xuICAgICAgdGhpcy5zcGVlZCA9IHRoaXMuZGVmYXVsdFNwZWVkO1xuICAgICAgdGhpcy5hdHRhY2sgPSBmYWxzZTtcbiAgICAgIHRoaXMuY3VycmVudFRhcmdldCA9IG51bGw7XG4gICAgfSk7XG4gIH1cblxuICBnZXRBdHRhY2tWYWx1ZSgpIHtcbiAgICByZXR1cm4gTWF0aC5yYW5kb20oKSAqIHRoaXMuYXR0YWNrU3RyZW5ndGg7XG4gIH1cblxuICB1cGRhdGVIZWFsdGhCYXIoKSB7XG4gICAgbGV0IGhlYWx0aFBlcmNlbnQgPSB0aGlzLmhlYWx0aC90aGlzLm1heEhlYWx0aDtcbiAgICBsZXQgaGVhbHRoQmFyT2Zmc2V0ID0gLSgxLWhlYWx0aFBlcmNlbnQpICogdGhpcy5faGVhbHRoQmFyV2lkdGggLyAyO1xuICAgIGxldCBmdWxsSGVhbHRoQmFyID0gdGhpcy5oZWFsdGhCYXIuZ2V0T2JqZWN0QnlOYW1lKCdGdWxsSGVhbHRoQmFyJyk7XG5cbiAgICBmdWxsSGVhbHRoQmFyLnNjYWxlLnggPSBoZWFsdGhQZXJjZW50O1xuICAgIGZ1bGxIZWFsdGhCYXIucG9zaXRpb24ueCA9IGhlYWx0aEJhck9mZnNldDtcbiAgfVxuXG4gIHJ1bkxvb3AodGltZXN0YW1wKSB7XG4gICAgdGhpcy5hdHRhY2tQcm9jZWR1cmUodGltZXN0YW1wKTtcbiAgICB0aGlzLnZpZXdPYmoucG9zaXRpb24ueCArPSAodGhpcy5zcGVlZCAqIHRoaXMuZGlyZWN0aW9uKTtcblxuICAgIHRoaXMuY29sbGlkZXIudXBkYXRlKCk7XG4gICAgdGhpcy51cGRhdGVIZWFsdGhCYXIoKTtcbiAgfVxuXG4gIGF0dGFja1Byb2NlZHVyZSh0aW1lc3RhbXApIHtcbiAgICBpZih0aGlzLmhlYWx0aCA8PSAwKSB7IHJldHVybjsgfVxuXG4gICAgaWYodGhpcy5hdHRhY2tQcm9wZXJ0aWVzLmxhc3RUaW1lU3RhbXAgIT0gbnVsbCAmJiB0aGlzLmF0dGFjaykge1xuICAgICAgbGV0IGRlbHRhID0gdGltZXN0YW1wIC0gdGhpcy5hdHRhY2tQcm9wZXJ0aWVzLmxhc3RUaW1lU3RhbXA7XG4gICAgICB0aGlzLmF0dGFja1Byb3BlcnRpZXMuYXR0YWNrVGltZSArPSBkZWx0YTtcbiAgICAgIHRoaXMuYXR0YWNrUHJvcGVydGllcy5sYXN0VGltZVN0YW1wID0gdGltZXN0YW1wO1xuICAgICAgdGhpcy5hdHRhY2tMb29wKCk7XG4gICAgfSBlbHNlIGlmKHRoaXMuYXR0YWNrKSB7XG4gICAgICB0aGlzLmF0dGFja1Byb3BlcnRpZXMuYXR0YWNrVGltZSA9IDA7XG4gICAgICB0aGlzLmF0dGFja1Byb3BlcnRpZXMubGFzdFRpbWVTdGFtcCA9IHRpbWVzdGFtcDtcbiAgICAgIHRoaXMuYXR0YWNrTG9vcCgpO1xuICAgIH1cblxuICAgIHRoaXMuYXR0YWNrUHJvcGVydGllcy5sYXN0VGltZVN0YW1wID0gdGltZXN0YW1wO1xuICB9XG5cbiAgYXR0YWNrTG9vcCgpIHtcbiAgICBpZih0aGlzLmN1cnJlbnRUYXJnZXQgPT09IG51bGwgfHwgdGhpcy5jdXJyZW50VGFyZ2V0LnBsYXllcklkID09PSB0aGlzLnBsYXllcklkKSB7IHJldHVybjsgfVxuICAgIGlmKHRoaXMuYXR0YWNrUHJvcGVydGllcy5hdHRhY2tUaW1lIDwgdGhpcy5hdHRhY2tTcGVlZCkgeyByZXR1cm47IH1cblxuICAgIHRoaXMuY3VycmVudFRhcmdldC5oZWFsdGggLT0gdGhpcy5nZXRBdHRhY2tWYWx1ZSgpO1xuXG4gICAgY29uc29sZS5sb2codGhpcy5pZCwgdGhpcy5oZWFsdGgpO1xuICAgIGlmKHRoaXMuY3VycmVudFRhcmdldC5oZWFsdGggPD0gMCkge1xuICAgICAgdGhpcy5wbGF5ZXIucHJvY2Vzc1Jld2FyZCh0aGlzLmN1cnJlbnRUYXJnZXQua2lsbFJld2FyZCk7XG5cbiAgICAgIHRoaXMuY3VycmVudFRhcmdldC5hdHRhY2sgPSBmYWxzZTtcbiAgICAgIHRoaXMuY3VycmVudFRhcmdldC5kZXN0cm95ID0gdHJ1ZTtcbiAgICAgIHRoaXMuY3VycmVudFRhcmdldCA9IG51bGw7XG4gICAgfVxuXG4gICAgdGhpcy5hdHRhY2tQcm9wZXJ0aWVzLmF0dGFja1RpbWUgPSAwO1xuICAgIHRoaXMuYXR0YWNrUHJvcGVydGllcy5sYXN0VGltZVN0YW1wID0gbnVsbDtcbiAgfVxufVxuIiwiaW1wb3J0IE1pbmlvbiBmcm9tICcuL21pbmlvbic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBsYXllciB7XG5cbiAgY29uc3RydWN0b3IoYXJncykge1xuICAgIHRoaXMudHlwZSA9IGFyZ3MudHlwZTtcbiAgICB0aGlzLmlkID0gYXJncy5pZDtcbiAgICB0aGlzLmRpcmVjdGlvbiA9IGFyZ3MuZGlyZWN0aW9uO1xuICAgIHRoaXMuY29sbGlkZXJMaXN0ID0gYXJncy5jb2xsaWRlckxpc3Q7XG4gICAgdGhpcy5zY2VuZSA9IGFyZ3Muc2NlbmU7XG4gICAgdGhpcy5taW5pb25JZCA9IDA7XG5cbiAgICB0aGlzLnNldHVwR2FtZVN0YXRlKCk7XG4gIH1cblxuICBzcGF3bk1pbmlvbihpbmRleCkgeyBcbiAgICBpZih0aGlzLm1vbmV5ID49IHRoaXMubWluaW9uQ29zdCkge1xuICAgICAgdGhpcy5tb25leSAtPSB0aGlzLm1pbmlvbkNvc3Q7XG5cbiAgICAgIGxldCBtaW5pb24gPSBuZXcgTWluaW9uKHtcbiAgICAgICAgaWQ6IHRoaXMubWluaW9uSWQrKyxcbiAgICAgICAgcGxheWVySWQ6IHRoaXMuaWQsXG4gICAgICAgIGRpcmVjdGlvbjogdGhpcy5kaXJlY3Rpb24sXG4gICAgICAgIHN0YXJ0aW5nWjogaW5kZXgsXG4gICAgICAgIGNvbGxpZGVyTGlzdDogdGhpcy5jb2xsaWRlckxpc3QsXG4gICAgICAgIHBsYXllcjogdGhpc1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMubWluaW9ucy5wdXNoKG1pbmlvbik7XG4gICAgICByZXR1cm4gbWluaW9uO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICBwcm9jZXNzUmV3YXJkKHJld2FyZCkge1xuICAgIGxldCB0ID0gdGhpcztcbiAgICBPYmplY3Qua2V5cyhyZXdhcmQpLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgdFtrZXldICs9IHJld2FyZFtrZXldO1xuICAgIH0pO1xuICB9XG5cbiAgcnVuTG9vcCh0aW1lc3RhbXApIHtcbiAgICB0aGlzLm1pbmlvbnMuZm9yRWFjaCgobWluaW9uLCBpbmRleCkgPT4ge1xuICAgICAgbWluaW9uLnJ1bkxvb3AodGltZXN0YW1wKTtcbiAgICAgIGlmKG1pbmlvbi5kZXN0cm95KSB7XG4gICAgICAgIHRoaXMuc2NlbmUucmVtb3ZlKG1pbmlvbi52aWV3T2JqKTtcblxuICAgICAgICBjb25zb2xlLmxvZyhpbmRleCwgdGhpcy5maW5kQ29sbGlkZXJJbmRleChtaW5pb24uY29sbGlkZXIuaWQpKTtcbiAgICAgICAgdGhpcy5jb2xsaWRlckxpc3Quc3BsaWNlKHRoaXMuZmluZENvbGxpZGVySW5kZXgobWluaW9uLmNvbGxpZGVyLmlkKSwgMSk7XG5cbiAgICAgICAgbGV0IGEgPSB0aGlzLm1pbmlvbnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIH1cbiAgICB9KTsgXG4gIH1cblxuICBmaW5kQ29sbGlkZXJJbmRleChpZCkge1xuICAgIGxldCBpbmRleCA9IC0xO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNvbGxpZGVyTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgaWYodGhpcy5jb2xsaWRlckxpc3RbaV0uaWQgPT09IGlkKSB7XG4gICAgICAgIGluZGV4ID0gaTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gaW5kZXg7XG4gIH1cblxuICBzZXR1cEdhbWVTdGF0ZSgpIHtcbiAgICB0aGlzLm1pbmlvbnMgPSBbXTtcbiAgICB0aGlzLnNjb3JlID0gMDtcbiAgICB0aGlzLm1vbmV5ID0gNDAwO1xuICAgIHRoaXMubWluaW9uQ29zdCA9IDIwO1xuICB9XG59XG4iLCJmdW5jdGlvbiBoYW5kbGVSZXNpemUocmVuZGVyZXIsIGNhbWVyYSl7XG4gIGxldCB3ID0gd2luZG93LmlubmVyV2lkdGg7XG4gIGxldCBoID0gd2luZG93LmlubmVySGVpZ2h0O1xuICByZW5kZXJlci5zZXRTaXplKHcsaCk7XG4gIGNhbWVyYS5hc3BlY3QgPSB3L2g7XG4gIGNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG59XG5cbmZ1bmN0aW9uIHNldHVwUmVzaXppbmcocmVuZGVyZXIsIGNhbWVyYSkge1xuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCkgPT4ge1xuICAgIGhhbmRsZVJlc2l6ZShyZW5kZXJlciwgY2FtZXJhKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXR1cFNjcmVlblZpZXcoKSB7XG4gIGxldCBzY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpO1xuICBsZXQgY2FtZXJhID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKDc1LCB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodCwgMC4xLCAxMDAwKTtcbiAgbGV0IHJlbmRlcmVyID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoKTtcblxuICByZW5kZXJlci5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHJlbmRlcmVyLmRvbUVsZW1lbnQpO1xuXG4gIHNldHVwUmVzaXppbmcocmVuZGVyZXIsIGNhbWVyYSk7XG5cbiAgcmV0dXJuIHsgc2NlbmUsIGNhbWVyYSwgcmVuZGVyZXIgfTtcbn1cbiJdfQ==\n"]}